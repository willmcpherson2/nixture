* Nixture

#+BEGIN_QUOTE
Nix for the web mixture
#+END_QUOTE

Nixture helps you build websites without getting in your way.

It adds:

- Templating (Jinja2)
- Markup (Org-mode)
- Backend compilers (GHC)
- Frontend compilers (GHCJS)

** Example

[[./example/default.nix][default.nix]]

#+BEGIN_SRC nix
  let
    inherit (import <nixpkgs> { }) symlinkJoin;
    inherit (import ./..) ghc ghcjs optimiseHaskellJs compileJinja;
  in
  symlinkJoin {
    name = "example";
    paths = [
      (ghc.callCabal2nix "server" ./server { })
      (optimiseHaskellJs (ghcjs.callCabal2nix "hs-script" ./client/hs-script { }))
      (compileJinja ./client/index.html)
    ];
  }
#+END_SRC

[[./example/client/index.html][client/index.html]]

#+BEGIN_SRC html
  <!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>example</title>
      <style>{% include "style.css" %}</style>
    </head>

    <body>
      <h2>HTML</h2>
      <pre><code>{% filter escape %}{% include "html-content.html" %}{% endfilter %}</code></pre>
      {% include "html-content.html" %}

      <h2>Org-mode</h2>
      <pre><code>{% filter escape %}{% include "org-content.org" %}{% endfilter %}</code></pre>
      {% include "org-content.html" %}

      <h2>JavaScript</h2>
      <pre><code>{% filter escape %}{% include "js-script.js" %}{% endfilter %}</code></pre>
      <div id="js-output"></div>
      <script>{% include "js-script.js" %}</script>

      <h2>Haskell</h2>
      <pre><code>{% filter escape %}{% include "hs-script/app/Main.hs" %}{% endfilter %}</code></pre>
      <div id="hs-output"></div>
      <script defer src="hs-script.js"></script>
    </body>
  </html>
#+END_SRC

Build:

#+BEGIN_SRC shell
  nix-build
#+END_SRC

This will compile the ~server~ Cabal project to a native binary, the
~hs-script~ Cabal project to JavaScript, and the ~index.html~ Jinja2
template to HTML. ~compileJinja~ automatically compiles markup files
so they can be ~include~'d freely.

Run server:

#+BEGIN_SRC shell
  ./result/bin/server result
#+END_SRC

./example/rendered.png
